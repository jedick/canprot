---
title: "Summary Table"
output: html_vignette
vignette: >
  %\VignetteIndexEntry{Summary Table}
  %\VignetteEngine{knitr::rmarkdown}
  \usepackage[utf8]{inputenc}
---

This table compares metrics for the chemical compositions of groups of human proteins that are relatively down- and up-expressed in colorectal cancer (`n1` and `n2`, respectively).


```{r options, echo=FALSE}
options(width = 90)
```

```{r canprot, message=FALSE}
library(canprot)
data(canprot)
```

Identify the datasets for protein expression.

```{r datasets}
datasets <- pdat_CRC()
```

Get the amino acid compositions of the up- and down-expressed proteins (`get_pdat`) and make comparisons of indicators of oxidation and hydration state (`ZC_nH2O`).

```{r comptab, results="hide", message=FALSE}
comptab <- lapply_canprot(datasets, function(dataset) {
  pdat <- get_pdat(dataset)
  ZC_nH2O(pdat, plot.it=FALSE)
})
```

Generate the HTML table with `xsummary`, which adds bold and underline formatting to the output of `xtable`.
The columns show the difference in means (`DM`), common language effect size (`ES`), and _p_-value (`p`) for comparisons between groups of the average oxidation state of carbon (`ZC`) and water demand per residue (`nH2O`).

```{r xsummary, results="asis"}
library(xtable)
xsummary(comptab)
```

The numeric values are the same as in Table 1 of [Dick (2016)](http://doi.org/10.7717/peerj.2238) (with the addition of the [`LXM+16`](data_sources.html#ref-LXM+16) dataset).
For these datasets, we find that the groups of proteins that are relatively up-expressed in cancer or more advanced cancer stages predominantly have higher `ZC` and/or `nH2O`.

***

Here is a graphical representation of the mean differences and _p_-values.
The adenoma / normal datasets are highlighted in red.

```{r diffplot, fig.width=6, fig.height=6, fig.align="center"}
col <- rep("black", length(datasets))
# highlight adenoma / normal datasets
col[grepl("=AD", datasets)] <- "red"
diffplot(comptab, col=col)
```
